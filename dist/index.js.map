{"version":3,"sources":["../src/components/App.tsx","../src/components/Controller.tsx","../src/components/Route.tsx","../src/components/Response.tsx","../src/components/Page.tsx","../src/components/Middleware.tsx","../src/components/Guard.tsx","../src/core/responseUtils.ts","../src/core/collectRoutes.ts","../src/config.ts","../src/core/bundlers/bun.bundler.ts","../src/core/bundlers/vite.bundler.ts","../src/core/bundler.ts","../src/core/componentExtractor.ts","../src/core/hotReload.ts","../src/core/spaDirective.ts","../src/core/createServer.ts"],"names":["React","props","path","fs","crypto2","path3","exports","fs3","fs4","path4","crypto3"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react';\nimport type { AppProps } from '../types';\n\n/**\n * App component - root component that starts the Fastify server\n * \n * @example\n * <App port={8080}>\n *   <Controller path=\"/api\">\n *     <Route path=\"/hello\" method=\"GET\" onRequest={() => ({ message: 'Hello' })} />\n *   </Controller>\n * </App>\n */\nexport function App(props: AppProps): React.ReactElement {\n    return React.createElement(React.Fragment, null, props.children);\n}\n\nApp.displayName = 'App';\n","import React from 'react';\nimport type { ControllerProps } from '../types';\n\n/**\n * Controller component - groups routes under a common path prefix\n * \n * @example\n * <Controller path=\"/api\">\n *   <Route path=\"/users\" method=\"GET\" onRequest={() => []} />\n * </Controller>\n */\nexport function Controller(props: ControllerProps): React.ReactElement {\n    return React.createElement(React.Fragment, null, props.children);\n}\n\nController.displayName = 'Controller';\n","import React from 'react';\nimport type { RouteProps } from '../types';\n\n/**\n * Route component - defines a single API endpoint\n * \n * @example\n * <Route\n *   path=\"/users/:id\"\n *   method=\"GET\"\n *   onRequest={({ params }) => ({ id: params.id })}\n * />\n */\nexport function Route<TParams = any, TQuery = any, TBody = any, TResponse = any>(\n    props: RouteProps<TParams, TQuery, TBody, TResponse>\n): null {\n    // This component is never rendered - it's only used for configuration\n    return null;\n}\n\nRoute.displayName = 'Route';\n","import React from 'react';\n\n/**\n * Response component - used as a declarative response returned from route handlers\n *\n * Props can be concrete values or functions that receive the current request context\n * (request, reply, params, query, body).\n */\nexport function Response(props: {\n    json?: any | ((ctx: any) => any);\n    status?: number | ((ctx: any) => number);\n    headers?: Record<string, string> | ((ctx: any) => Record<string, string>);\n    raw?: any; // allow sending raw reply if needed\n}): null {\n    // This component is not rendered; it's inspected by the server at runtime\n    return null;\n}\n\nResponse.displayName = 'Response';\n\nexport default Response;\n","import React from 'react';\n\nexport interface PageProps {\n    /**\n     * The React component/elements to render as the page content\n     * - For static SSR: pass any React elements\n     * - For client-side SPA: pass a single function component (will be auto-bundled)\n     */\n    children?: React.ReactNode;\n\n    /**\n     * Enable client-side rendering (SPA mode)\n     * When true, the component in children will be bundled and rendered client-side\n     * @default false\n     */\n    spa?: boolean;\n\n    /**\n     * Page title (will be set in <title> tag)\n     */\n    title?: string | ((ctx: any) => string);\n\n    /**\n     * Additional meta tags\n     */\n    meta?: Array<{ name?: string; property?: string; content: string }> | ((ctx: any) => Array<{ name?: string; property?: string; content: string }>);\n\n    /**\n     * Additional links (stylesheets, etc.)\n     */\n    links?: Array<{ rel: string; href: string;[key: string]: string }> | ((ctx: any) => Array<{ rel: string; href: string;[key: string]: string }>);\n\n    /**\n     * Scripts to include in the page\n     */\n    scripts?: Array<{ src?: string; content?: string; async?: boolean; defer?: boolean; type?: string }> | ((ctx: any) => Array<{ src?: string; content?: string; async?: boolean; defer?: boolean; type?: string }>);\n\n    /**\n     * Additional CSS to inline in a <style> tag\n     */\n    styles?: string | ((ctx: any) => string);\n\n    /**\n     * HTTP status code\n     */\n    status?: number | ((ctx: any) => number);\n\n    /**\n     * Additional HTTP headers\n     */\n    headers?: Record<string, string> | ((ctx: any) => Record<string, string>);\n\n    /**\n     * Language for the html tag\n     */\n    lang?: string;\n\n    /**\n     * Custom DOCTYPE (defaults to HTML5)\n     */\n    doctype?: string;\n\n    /**\n     * Additional attributes for the <html> tag\n     */\n    htmlAttributes?: Record<string, string>;\n\n    /**\n     * Additional attributes for the <body> tag\n     */\n    bodyAttributes?: Record<string, string>;\n\n    /**\n     * Root element ID for the content container (defaults to 'root')\n     */\n    rootId?: string;\n}/**\n * Page component - renders a full HTML page with optional client-side React SPA\n * \n * The Page component can work in two modes:\n * 1. **Static SSR** (default): Renders React components to static HTML (no client-side JS)\n * 2. **SPA Mode** (spa=true): Bundles your component and renders it client-side with full interactivity\n * \n * @example\n * // Static HTML only (fast, no JavaScript)\n * <Page title=\"Static Page\">\n *   <div><h1>Hello</h1></div>\n * </Page>\n * \n * @example\n * // Interactive SPA with client-side React (useState, useEffect work!)\n * <Page title=\"Dashboard\" spa={true}>\n *   <Dashboard userId={params.id} />\n * </Page>\n */\nexport function Page(props: PageProps): null {\n    // This component is not rendered; it's inspected by the server at runtime\n    return null;\n}\n\nPage.displayName = 'Page';\n\nexport default Page;\n","import React from 'react';\nimport type { Middleware as MiddlewareFunction } from '../types';\n\nexport interface MiddlewareProps {\n    use: MiddlewareFunction | MiddlewareFunction[];\n    children: React.ReactNode;\n}\n\n/**\n * Middleware component - wraps routes/controllers to apply middleware\n * \n * @example\n * <Middleware use={[loggingMiddleware, corsMiddleware]}>\n *   <Route path=\"/users\" method=\"GET\" onRequest={...} />\n * </Middleware>\n */\nexport function Middleware(props: MiddlewareProps): React.ReactElement {\n    return React.createElement(React.Fragment, null, props.children);\n}\n\nMiddleware.displayName = 'Middleware';\n","import React from 'react';\nimport type { Guard as GuardFunction } from '../types';\n\nexport interface GuardProps {\n    use: GuardFunction | GuardFunction[];\n    children: React.ReactNode;\n}\n\n/**\n * Guard component - wraps routes/controllers to apply guards\n * \n * @example\n * <Guard use={[authGuard, adminGuard]}>\n *   <Route path=\"/admin\" method=\"GET\" onRequest={...} />\n * </Guard>\n */\nexport function Guard(props: GuardProps): React.ReactElement {\n    return React.createElement(React.Fragment, null, props.children);\n}\n\nGuard.displayName = 'Guard';\n","import React from \"react\";\n\n// Resolve a value that may be a function(ctx) or a plain value. Works recursively for objects/arrays.\nexport function resolveWithContext(value: any, ctx: any): any {\n  if (typeof value === \"function\") {\n    try {\n      return value(ctx);\n    } catch (err) {\n      // if function expects no args and throws, propagate\n      throw err;\n    }\n  }\n\n  if (Array.isArray(value)) {\n    return value.map((v) => resolveWithContext(v, ctx));\n  }\n\n  if (value && typeof value === \"object\") {\n    const out: any = {};\n    for (const key of Object.keys(value)) {\n      out[key] = resolveWithContext(value[key], ctx);\n    }\n    return out;\n  }\n\n  return value;\n}\n\n// Helper 'hook' that returns a function which extracts a key from the context.\nexport function useContext(key: string) {\n  return (ctx: any) => ctx?.[key];\n}\n\n// Convenience: helper to get header value from ctx\nexport function getHeader(name: string) {\n  return (ctx: any) => ctx?.request?.headers?.[name.toLowerCase()];\n}\n\n// Detect if something is a React element of our Response type\nexport function isResponseElement(val: any) {\n  return React.isValidElement(val) && (val.type as any)?.displayName === \"Response\";\n}\n\n// Detect if something is a React element of our Page type\nexport function isPageElement(val: any) {\n  return React.isValidElement(val) && (val.type as any)?.displayName === \"Page\";\n}\n","import React from \"react\";\nimport type { CollectedRoute, HTTPMethod, RouteHandler, Guard, Middleware } from \"../types\";\nimport { Route } from \"../components/Route\";\nimport { Controller } from \"../components/Controller\";\nimport { Middleware as MiddlewareComponent } from \"../components/Middleware\";\nimport { Guard as GuardComponent } from \"../components/Guard\";\n\n/**\n * Recursively traverses a React element tree and collects route definitions\n *\n * @param element - The React element to traverse\n * @param basePath - The accumulated base path from parent Controllers\n * @param parentGuards - Guards from parent Controllers\n * @param parentMiddlewares - Middlewares from parent Controllers\n * @returns Array of collected routes with their full paths and handlers\n */\nexport function collectRoutes(\n  element: React.ReactElement | null,\n  basePath: string = \"\",\n  parentGuards: Guard[] = [],\n  parentMiddlewares: Middleware[] = []\n): CollectedRoute[] {\n  if (!element) {\n    return [];\n  }\n\n  const routes: CollectedRoute[] = [];\n\n  // Handle Route component\n  if (element.type === Route) {\n    const props = element.props as any;\n    const fullPath = joinPaths(basePath, props.path);\n    const methods = Array.isArray(props.method) ? props.method : [props.method];\n\n    // Combine parent guards/middlewares with route-specific ones\n    const routeGuards = [...parentGuards, ...(props.guards || [])];\n    const routeMiddlewares = [...parentMiddlewares, ...(props.middlewares || [])];\n\n    for (const method of methods) {\n      routes.push({\n        path: fullPath,\n        method: method as HTTPMethod,\n        handler: props.onRequest as RouteHandler,\n        schema: props.schema,\n        guards: routeGuards,\n        middlewares: routeMiddlewares,\n      });\n    }\n\n    return routes;\n  }\n\n  // Handle Controller component\n  if (element.type === Controller) {\n    const props = element.props as any;\n    const newBasePath = joinPaths(basePath, props.path);\n\n    // Combine parent guards/middlewares with controller-specific ones\n    const controllerGuards = [...parentGuards, ...(props.guards || [])];\n    const controllerMiddlewares = [...parentMiddlewares, ...(props.middlewares || [])];\n\n    // Recursively collect routes from children\n    const children = React.Children.toArray(props.children);\n    for (const child of children) {\n      if (React.isValidElement(child)) {\n        routes.push(...collectRoutes(child, newBasePath, controllerGuards, controllerMiddlewares));\n      }\n    }\n\n    return routes;\n  }\n\n  // Handle Middleware component\n  if (element.type === MiddlewareComponent) {\n    const props = element.props as any;\n    const use = props.use;\n    const middlewares = Array.isArray(use) ? use : [use];\n\n    // Add these middlewares to the parent stack\n    const newMiddlewares = [...parentMiddlewares, ...middlewares];\n\n    // Recursively collect routes from children\n    const children = React.Children.toArray(props.children);\n    for (const child of children) {\n      if (React.isValidElement(child)) {\n        routes.push(...collectRoutes(child, basePath, parentGuards, newMiddlewares));\n      }\n    }\n\n    return routes;\n  }\n\n  // Handle Guard component\n  if (element.type === GuardComponent) {\n    const props = element.props as any;\n    const use = props.use;\n    const guards = Array.isArray(use) ? use : [use];\n\n    // Add these guards to the parent stack\n    const newGuards = [...parentGuards, ...guards];\n\n    // Recursively collect routes from children\n    const children = React.Children.toArray(props.children);\n    for (const child of children) {\n      if (React.isValidElement(child)) {\n        routes.push(...collectRoutes(child, basePath, newGuards, parentMiddlewares));\n      }\n    }\n\n    return routes;\n  }\n\n  // Handle function components (like AuthController, UsersController, etc.)\n  if (\n    typeof element.type === \"function\" &&\n    element.type !== Route &&\n    element.type !== Controller &&\n    element.type !== MiddlewareComponent &&\n    element.type !== GuardComponent\n  ) {\n    const props = element.props as any;\n    const Component = element.type as any;\n\n    // Check if it's a class component or function component\n    let rendered;\n    if (Component.prototype && Component.prototype.isReactComponent) {\n      // Class component\n      const instance = new Component(props);\n      rendered = instance.render();\n    } else {\n      // Function component\n      rendered = Component(props);\n    }\n\n    if (React.isValidElement(rendered)) {\n      routes.push(...collectRoutes(rendered, basePath, parentGuards, parentMiddlewares));\n    }\n    return routes;\n  }\n\n  // Handle Fragment or other container components\n  const props = element.props as any;\n  if (props?.children) {\n    const children = React.Children.toArray(props.children);\n    for (const child of children) {\n      if (React.isValidElement(child)) {\n        routes.push(...collectRoutes(child, basePath, parentGuards, parentMiddlewares));\n      }\n    }\n  }\n\n  return routes;\n}\n\n/**\n * Joins path segments, ensuring no duplicate slashes\n */\nfunction joinPaths(...paths: string[]): string {\n  return paths\n    .filter(Boolean)\n    .map((p) => p.replace(/^\\/+|\\/+$/g, \"\"))\n    .filter(Boolean)\n    .join(\"/\")\n    .replace(/^/, \"/\");\n}\n","export interface ReactServerAppConfig {\n  /**\n   * Bundler to use for client-side components\n   * @default 'bun'\n   */\n  bundler?: \"bun\" | \"vite\";\n\n  /**\n   * Directory to output bundled files (relative to project root)\n   * @default '.react-server-app/bundles'\n   */\n  bundleOutputDir?: string;\n\n  /**\n   * Whether to minify the bundled JavaScript\n   * @default true\n   */\n  minify?: boolean;\n\n  /**\n   * Whether to generate sourcemaps\n   * @default false in production, true in development\n   */\n  sourcemap?: boolean;\n\n  /**\n   * Cache bundled components\n   * @default true\n   */\n  cache?: boolean;\n\n  /**\n   * Directories to scan for \"use spa\" components\n   * @default ['src', 'app', 'pages', 'components']\n   */\n  spaComponentDirs?: string[];\n\n  /**\n   * Patterns to exclude when scanning for \"use spa\" components\n   * @default ['node_modules', 'dist', 'build', '.next', '.git']\n   */\n  spaComponentExclude?: string[];\n}\n\nlet currentConfig: ReactServerAppConfig = {\n  bundler: \"bun\",\n  bundleOutputDir: \".react-server-app/bundles\",\n  minify: process.env.NODE_ENV === \"production\",\n  sourcemap: process.env.NODE_ENV === \"development\",\n  cache: true,\n  spaComponentDirs: [\"src\", \"app\", \"pages\", \"components\"],\n  spaComponentExclude: [\"node_modules\", \"dist\", \"build\", \".next\", \".git\"],\n};\n\n/**\n * Configure the React Server App framework\n */\nexport function configure(config: ReactServerAppConfig): void {\n  currentConfig = { ...currentConfig, ...config };\n}\n\n/**\n * Get the current configuration\n */\nexport function getConfig(): ReactServerAppConfig {\n  return { ...currentConfig };\n}\n","import * as crypto from \"crypto\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport { getConfig } from \"../../config\";\nimport type { BundleOptions, BundleResult, Bundler } from \"./types\";\n\nexport class BunBundler implements Bundler {\n  async bundle(filePath: string, options?: BundleOptions): Promise<BundleResult> {\n    const config = getConfig();\n    const absolutePath = path.isAbsolute(filePath) ? filePath : path.resolve(process.cwd(), filePath);\n\n    // Check if file exists\n    if (!fs.existsSync(absolutePath)) {\n      throw new Error(`Component file not found: ${absolutePath}`);\n    }\n\n    // Generate hash from file path and content for caching\n    const fileContent = fs.readFileSync(absolutePath, \"utf-8\");\n    const hash = crypto\n      .createHash(\"md5\")\n      .update(absolutePath + fileContent)\n      .digest(\"hex\");\n\n    // Create entry file in the same directory as the component so module resolution works\n    const componentDir = path.dirname(absolutePath);\n    const entryFile = path.join(componentDir, `.entry-${hash}.tsx`);\n\n    // Create entry file that imports the component and sets up client-side rendering\n    const componentName = path.basename(absolutePath, path.extname(absolutePath));\n    const componentExt = path.extname(absolutePath);\n    const clientCode = `\nimport React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport ${componentName} from './${componentName}${componentExt}';\n\n// Get initial props from window if they exist\nconst initialProps = (window as any).__INITIAL_PROPS__ || {};\n\n// Render the app on the client\nconst root = document.getElementById('root');\nif (root) {\n  createRoot(root).render(React.createElement(${componentName}, initialProps));\n}\n`;\n\n    fs.writeFileSync(entryFile, clientCode);\n\n    try {\n      // Use Bun's built-in bundler - output directly to memory\n      const build = await Bun.build({\n        entrypoints: [entryFile],\n        minify: options?.minify ?? config.minify,\n        sourcemap: options?.sourcemap ?? config.sourcemap ? \"inline\" : \"none\",\n        target: \"browser\",\n      });\n\n      if (!build.success) {\n        const errorMessages = build.logs\n          .map((l) => {\n            if (typeof l === \"object\" && \"message\" in l) {\n              return l.message;\n            }\n            return String(l);\n          })\n          .join(\"\\n\");\n        throw new Error(`Failed to bundle component:\\n${errorMessages || \"Unknown bundling error\"}`);\n      }\n\n      if (build.outputs.length === 0) {\n        throw new Error(\"No output from bundler\");\n      }\n\n      // Read the bundled code directly from Bun's output (no file I/O)\n      const code = await build.outputs[0].text();\n\n      // Clean up entry file\n      fs.unlinkSync(entryFile);\n\n      return { code, hash };\n    } catch (error) {\n      // Clean up on error\n      try {\n        fs.unlinkSync(entryFile);\n      } catch (e) {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n  }\n}\n","import * as crypto from \"crypto\";\nimport * as fs from \"fs\";\nimport * as path from \"path\";\nimport { getConfig } from \"../../config\";\nimport type { BundleOptions, BundleResult, Bundler } from \"./types\";\n\nexport class ViteBundler implements Bundler {\n  async bundle(filePath: string, options?: BundleOptions): Promise<BundleResult> {\n    const config = getConfig();\n    const absolutePath = path.isAbsolute(filePath) ? filePath : path.resolve(process.cwd(), filePath);\n\n    // Check if file exists\n    if (!fs.existsSync(absolutePath)) {\n      throw new Error(`Component file not found: ${absolutePath}`);\n    }\n\n    // Generate hash from file path and content for caching\n    const fileContent = fs.readFileSync(absolutePath, \"utf-8\");\n    const hash = crypto\n      .createHash(\"md5\")\n      .update(absolutePath + fileContent)\n      .digest(\"hex\");\n\n    // Dynamically import vite\n    let vite: any;\n    try {\n      // @ts-ignore - Vite is an optional dependency\n      vite = await import(\"vite\");\n    } catch (error) {\n      throw new Error(\"Vite is not installed. Please run: npm install vite @vitejs/plugin-react\");\n    }\n\n    // Create entry file in the same directory as the component so module resolution works\n    const componentDir = path.dirname(absolutePath);\n    const entryFile = path.join(componentDir, `.entry-${hash}.tsx`);\n    const outDir = path.join(componentDir, `.vite-out-${hash}`);\n\n    // Create entry file that imports the component and sets up client-side rendering\n    const componentName = path.basename(absolutePath, path.extname(absolutePath));\n    const componentExt = path.extname(absolutePath);\n    const clientCode = `\nimport React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport ${componentName} from './${componentName}${componentExt}';\n\n// Get initial props from window if they exist\nconst initialProps = (window as any).__INITIAL_PROPS__ || {};\n\n// Render the app on the client\nconst root = document.getElementById('root');\nif (root) {\n  createRoot(root).render(React.createElement(${componentName}, initialProps));\n}\n`;\n\n    fs.writeFileSync(entryFile, clientCode);\n\n    try {\n      // Build with Vite\n      await vite.build({\n        configFile: false,\n        logLevel: \"error\", // Minimize console output\n        define: {\n          \"process.env.NODE_ENV\": JSON.stringify(options?.minify ? \"production\" : \"development\"),\n        },\n        build: {\n          outDir,\n          emptyOutDir: true,\n          minify: options?.minify ?? config.minify,\n          sourcemap: options?.sourcemap ?? config.sourcemap,\n          rollupOptions: {\n            input: entryFile,\n            output: {\n              format: \"es\",\n              entryFileNames: \"bundle.js\",\n            },\n          },\n          write: true,\n          target: \"es2015\",\n        },\n        plugins: [\n          // @ts-ignore - Vite plugin is an optional dependency\n          (await import(\"@vitejs/plugin-react\")).default(),\n        ],\n      });\n\n      // Read the bundled code\n      const bundleFile = path.join(outDir, \"bundle.js\");\n      if (!fs.existsSync(bundleFile)) {\n        throw new Error(\"Vite build did not produce expected output\");\n      }\n\n      const code = fs.readFileSync(bundleFile, \"utf-8\");\n\n      // Clean up temp files\n      try {\n        fs.unlinkSync(entryFile);\n        fs.rmSync(outDir, { recursive: true, force: true });\n      } catch (e) {\n        // Ignore cleanup errors\n      }\n\n      return { code, hash };\n    } catch (error) {\n      // Clean up on error\n      try {\n        fs.unlinkSync(entryFile);\n        fs.rmSync(outDir, { recursive: true, force: true });\n      } catch (e) {\n        // Ignore cleanup errors\n      }\n      throw error;\n    }\n  }\n}\n","import { getConfig } from \"../config\";\nimport { BunBundler, ViteBundler } from \"./bundlers\";\nimport type { BundleOptions, BundleResult, Bundler } from \"./bundlers\";\n\n// Cache for bundled components\nconst bundleCache = new Map<string, BundleResult>();\n\n// Bundler instances\nlet bunBundler: Bundler | null = null;\nlet viteBundler: Bundler | null = null;\n\n/**\n * Get or create bundler instance\n */\nfunction getBundler(): Bundler {\n  const config = getConfig();\n  let bundlerType = config.bundler || \"bun\";\n\n  // Auto-detect: if Bun is not available, use Vite\n  if (bundlerType === \"bun\" && typeof Bun === \"undefined\") {\n    console.log(\"[bundler] Bun not available, falling back to Vite\");\n    bundlerType = \"vite\";\n  }\n\n  if (bundlerType === \"vite\") {\n    if (!viteBundler) {\n      viteBundler = new ViteBundler();\n    }\n    return viteBundler;\n  } else {\n    if (!bunBundler) {\n      bunBundler = new BunBundler();\n    }\n    return bunBundler;\n  }\n}\n\n/**\n * Bundle a React component file for the browser\n */\nexport async function bundleComponentFile(filePath: string, options?: BundleOptions): Promise<BundleResult> {\n  const config = getConfig();\n  const bundler = getBundler();\n\n  // Generate a cache key from the file path\n  const bundle = await bundler.bundle(filePath, options);\n\n  // Cache the result\n  if (config.cache) {\n    bundleCache.set(bundle.hash, bundle);\n  }\n\n  return bundle;\n}\n\n/**\n * Clear the bundle cache\n */\nexport function clearBundleCache(): void {\n  bundleCache.clear();\n}\n\n/**\n * Get bundle from cache\n */\nexport function getBundleFromCache(hash: string): BundleResult | undefined {\n  return bundleCache.get(hash);\n}\n\n// Re-export types for convenience\nexport type { BundleOptions, BundleResult, Bundler } from \"./bundlers\";\n","import React from \"react\";\nimport * as path from \"path\";\n\n// Component registry for manual registration (fallback)\nconst componentRegistry = new Map<Function, string>();\n\n// SPA component registry (auto-discovered via \"use spa\" directive)\nlet spaComponentRegistry: Map<string, string> | null = null;\n\n/**\n * Set the SPA component registry (called during server initialization)\n * @internal\n */\nexport function setSpaComponentRegistry(registry: Map<string, string>) {\n  spaComponentRegistry = registry;\n}\n\n/**\n * Register a component with its file path manually (fallback method)\n * \n * @deprecated Prefer using \"use spa\" directive at the top of your component file\n * \n * @example\n * ```ts\n * import { registerComponent } from 'react-server-app';\n * import LandingPage from './pages/LandingPage';\n *\n * registerComponent(LandingPage, './pages/LandingPage.tsx');\n * ```\n */\nexport function registerComponent(component: Function, filePath: string) {\n  const absolutePath = path.isAbsolute(filePath) ? filePath : path.resolve(process.cwd(), filePath);\n  componentRegistry.set(component, absolutePath);\n}\n\n/**\n * Extract component information from a React element\n */\nexport function extractComponentInfo(element: React.ReactElement): {\n  filePath: string | null;\n  props: Record<string, any>;\n  componentName: string | null;\n} {\n  const component = element.type;\n\n  if (typeof component !== \"function\") {\n    return { filePath: null, props: {}, componentName: null };\n  }\n\n  // Get component name\n  const componentName = (component as any).displayName || (component as any).name || \"Component\";\n\n  // Get props\n  const props = element.props || {};\n\n  // Try to extract file path from the component function\n  let filePath: string | null = null;\n\n  // 1. Check SPA component registry (auto-discovered via \"use spa\" directive)\n  if (spaComponentRegistry && spaComponentRegistry.has(componentName)) {\n    filePath = spaComponentRegistry.get(componentName)!;\n    console.log(`[componentExtractor] Found SPA component ${componentName} in registry: ${filePath}`);\n    return { filePath, props, componentName };\n  }\n\n  // 2. Check manual component registry (fallback)\n  if (componentRegistry.has(component)) {\n    filePath = componentRegistry.get(component)!;\n    console.log(`[componentExtractor] Found component ${componentName} in manual registry: ${filePath}`);\n    return { filePath, props, componentName };\n  }\n\n  // 3. Try to get from require.cache (works in Bun and tsx)\n  try {\n    if (typeof require !== \"undefined\" && (require as any).cache) {\n      const requireCache = (require as any).cache as Record<string, any>;\n\n      // Look through all cached modules\n      for (const [modulePath, moduleData] of Object.entries(requireCache)) {\n        if (!moduleData || !moduleData.exports) continue;\n\n        // Skip node_modules and built-in modules\n        if (modulePath.includes(\"node_modules\") || !modulePath.includes(path.sep)) {\n          continue;\n        }\n\n        // Check if this module exports our component\n        const exports = moduleData.exports;\n\n        // Check default export\n        if (exports.default === component) {\n          filePath = modulePath;\n          console.log(`[componentExtractor] Found component ${componentName} via default export in: ${modulePath}`);\n          return { filePath, props, componentName };\n        }\n\n        // Check named exports\n        if (typeof exports === \"object\") {\n          for (const key of Object.keys(exports)) {\n            if (exports[key] === component) {\n              filePath = modulePath;\n              console.log(`[componentExtractor] Found component ${componentName} via named export '${key}' in: ${modulePath}`);\n              return { filePath, props, componentName };\n            }\n          }\n        }\n      }\n    }\n  } catch (e) {\n    // Module cache not available\n    console.log(`[componentExtractor] require.cache not available:`, (e as Error).message);\n  }\n\n  console.log(`[componentExtractor] Could not find file path for component: ${componentName}`);\n  console.log(`[componentExtractor] Add \"use spa\" directive to your component file:`);\n  console.log(`[componentExtractor]   // ${componentName}.tsx`);\n  console.log(`[componentExtractor]   \"use spa\";`);\n  console.log(`[componentExtractor]   `);\n  console.log(`[componentExtractor]   export default function ${componentName}() { ... }`);\n\n  return {\n    filePath,\n    props,\n    componentName,\n  };\n}\n\n/**\n * Check if a React element is a client component that should be bundled\n */\nexport function isClientComponent(element: React.ReactElement): boolean {\n  // It's a client component if it's a function component (not a built-in DOM element)\n  return typeof element.type === \"function\" && typeof element.type !== \"string\";\n}\n","import * as fs from \"fs\";\nimport { clearBundleCache } from \"./bundler\";\n\nconst watchedFiles = new Set<string>();\nconst fileWatchers = new Map<string, fs.FSWatcher>();\n\n/**\n * Watch a component file for changes and clear cache when it changes\n */\nexport function watchComponentFile(filePath: string, onReload?: () => void): void {\n  if (watchedFiles.has(filePath)) {\n    return; // Already watching\n  }\n\n  watchedFiles.add(filePath);\n\n  const watcher = fs.watch(filePath, (eventType) => {\n    if (eventType === \"change\") {\n      console.log(`[hotReload] File changed: ${filePath}`);\n      clearBundleCache();\n      onReload?.();\n    }\n  });\n\n  fileWatchers.set(filePath, watcher);\n}\n\n/**\n * Stop watching all files\n */\nexport function stopWatching(): void {\n  for (const watcher of fileWatchers.values()) {\n    watcher.close();\n  }\n  fileWatchers.clear();\n  watchedFiles.clear();\n}\n","import * as fs from \"fs\";\nimport * as path from \"path\";\n\n/**\n * Check if a file has the \"use spa\" directive\n */\nexport function hasSpaDirective(filePath: string): boolean {\n  try {\n    const content = fs.readFileSync(filePath, \"utf-8\");\n    // Match \"use spa\" or 'use spa' at the start of the file (ignoring whitespace/comments)\n    return /^['\"]use spa['\"];?\\s*$/m.test(content);\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Extract the exported component name from a file\n * Handles: export default ComponentName, export { ComponentName }, etc.\n */\nfunction getExportedComponentName(filePath: string): string | null {\n  try {\n    const content = fs.readFileSync(filePath, \"utf-8\");\n\n    // Match: export default function ComponentName\n    let match = content.match(/export\\s+default\\s+(?:function|const|class)\\s+(\\w+)/);\n    if (match) return match[1];\n\n    // Match: const ComponentName = ... \\n export default ComponentName\n    const defaultMatch = content.match(/export\\s+default\\s+(\\w+)/);\n    if (defaultMatch) {\n      const componentName = defaultMatch[1];\n      // Verify it's defined in the file (not just re-exported)\n      if (content.includes(`const ${componentName}`) || content.includes(`function ${componentName}`)) {\n        return componentName;\n      }\n    }\n\n    // Match: export function ComponentName or export const ComponentName\n    match = content.match(/export\\s+(?:function|const)\\s+(\\w+)/);\n    if (match) return match[1];\n\n    // Fallback: use filename\n    return null;\n  } catch (e) {\n    return null;\n  }\n}\n\n/**\n * Discover all SPA components in a directory recursively\n */\nexport function discoverSpaComponents(\n  rootDir: string,\n  options: {\n    include?: string[]; // directories to scan\n    exclude?: string[]; // patterns to exclude\n  } = {}\n): Map<string, string> {\n  const spaComponents = new Map<string, string>();\n  const include = options.include || [\"src\", \"app\", \"pages\", \"components\"];\n  const exclude = options.exclude || [\"node_modules\", \"dist\", \"build\", \".next\", \".git\"];\n\n  function scanDirectory(dir: string) {\n    if (!fs.existsSync(dir)) return;\n\n    try {\n      const entries = fs.readdirSync(dir, { withFileTypes: true });\n\n      for (const entry of entries) {\n        const fullPath = path.join(dir, entry.name);\n\n        // Skip excluded directories\n        if (entry.isDirectory()) {\n          const shouldExclude = exclude.some((pattern) => entry.name === pattern || entry.name.startsWith(\".\"));\n          if (!shouldExclude) {\n            scanDirectory(fullPath);\n          }\n          continue;\n        }\n\n        // Check if it's a component file\n        if (entry.isFile() && /\\.(tsx?|jsx?)$/.test(entry.name)) {\n          if (hasSpaDirective(fullPath)) {\n            // Extract component name from file\n            const baseName = path.basename(entry.name, path.extname(entry.name));\n\n            // Try to get the actual exported component name\n            const componentName = getExportedComponentName(fullPath) || baseName;\n\n            spaComponents.set(componentName, fullPath);\n            console.log(`[spaDirective] Discovered SPA component: ${componentName}  ${fullPath}`);\n          }\n        }\n      }\n    } catch (e) {\n      console.warn(`[spaDirective] Failed to scan directory: ${dir}`, e);\n    }\n  }\n\n  // Scan each included directory\n  for (const dir of include) {\n    const fullDir = path.resolve(rootDir, dir);\n    scanDirectory(fullDir);\n  }\n\n  return spaComponents;\n}\n\n/**\n * Initialize SPA component registry at server startup\n */\nexport function initializeSpaComponentRegistry(\n  rootDir?: string,\n  options?: {\n    include?: string[];\n    exclude?: string[];\n  }\n): Map<string, string> {\n  const workingDir = rootDir || process.cwd();\n  console.log('[spaDirective] Scanning for \"use spa\" components...');\n  const discovered = discoverSpaComponents(workingDir, options);\n  console.log(`[spaDirective] Found ${discovered.size} SPA component(s)`);\n  return discovered;\n}\n","import Fastify, { FastifyInstance } from \"fastify\";\nimport React from \"react\";\nimport { renderToString } from \"react-dom/server\";\nimport type { AppProps, RouteContext } from \"../types\";\nimport { collectRoutes } from \"./collectRoutes\";\nimport { isResponseElement, isPageElement, resolveWithContext } from \"./responseUtils\";\nimport { bundleComponentFile } from \"./bundler\";\nimport { extractComponentInfo, isClientComponent, setSpaComponentRegistry } from \"./componentExtractor\";\nimport { watchComponentFile } from \"./hotReload\";\nimport { initializeSpaComponentRegistry } from \"./spaDirective\";\nimport { getConfig } from \"../config\";\nimport * as crypto from \"crypto\";\n\n// Store for component bundles served as static files\nconst componentBundles = new Map<string, string>();\n// Store for initial props scripts\nconst propsScripts = new Map<string, string>();\n\n/**\n * Creates and starts a Fastify server from a React element tree\n *\n * @param element - The root React element (typically <App>)\n * @returns Promise that resolves to the Fastify instance\n */\nexport async function createServer(element: React.ReactElement): Promise<FastifyInstance> {\n  const props = element.props as AppProps;\n  const port = props.port ?? 3000;\n  const host = props.host ?? \"0.0.0.0\";\n  const staticDir = props.staticDir;\n  const staticPrefix = props.staticPrefix ?? \"/\";\n\n  // Initialize SPA component registry at startup\n  const config = getConfig();\n  const spaRegistry = initializeSpaComponentRegistry(undefined, {\n    include: config.spaComponentDirs,\n    exclude: config.spaComponentExclude,\n  });\n  setSpaComponentRegistry(spaRegistry);\n\n  // Create Fastify instance\n  const fastify = Fastify({\n    logger: true,\n  });\n\n  // Register static file serving if configured\n  if (staticDir) {\n    try {\n      // @ts-ignore - fastify-static types may not be available\n      const fastifyStatic = await import(\"@fastify/static\");\n      await fastify.register(fastifyStatic.default, {\n        root: staticDir,\n        prefix: staticPrefix,\n      });\n      console.log(` Static files enabled: ${staticDir} -> ${staticPrefix}`);\n    } catch (error) {\n      console.warn(\"  Static file serving requested but @fastify/static is not installed.\", \"\\n   Install it with: bun add @fastify/static\");\n    }\n  }\n\n  // Collect all routes from the React tree (traverse App's children)\n  const children = React.Children.toArray(props.children);\n  const routes: any[] = [];\n  for (const child of children) {\n    if (React.isValidElement(child)) {\n      routes.push(...collectRoutes(child));\n    }\n  }\n\n  console.log(`\\n Registering ${routes.length} route(s)...\\n`);\n\n  // Register route to serve bundled JavaScript files\n  fastify.get(\"/__bundles/:hash.js\", async (request, reply) => {\n    const { hash } = request.params as { hash: string };\n    const bundle = componentBundles.get(hash);\n\n    if (!bundle) {\n      reply.code(404);\n      return { error: \"Bundle not found\" };\n    }\n\n    reply.header(\"Content-Type\", \"application/javascript; charset=utf-8\");\n\n    // In development, use no-cache; in production use immutable\n    if (process.env.NODE_ENV === \"development\") {\n      reply.header(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n      reply.header(\"Pragma\", \"no-cache\");\n      reply.header(\"Expires\", \"0\");\n    } else {\n      reply.header(\"Cache-Control\", \"public, max-age=31536000, immutable\");\n    }\n\n    return reply.send(bundle);\n  });\n\n  // Register route to serve initial props scripts\n  fastify.get(\"/__props/:hash.js\", async (request, reply) => {\n    const { hash } = request.params as { hash: string };\n    const script = propsScripts.get(hash);\n\n    if (!script) {\n      reply.code(404);\n      return { error: \"Props script not found\" };\n    }\n\n    reply.header(\"Content-Type\", \"application/javascript; charset=utf-8\");\n\n    // In development, use no-cache; in production use immutable\n    if (process.env.NODE_ENV === \"development\") {\n      reply.header(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n      reply.header(\"Pragma\", \"no-cache\");\n      reply.header(\"Expires\", \"0\");\n    } else {\n      reply.header(\"Cache-Control\", \"public, max-age=31536000, immutable\");\n    }\n\n    return reply.send(script);\n  });\n\n  // Register routes with Fastify\n  for (const route of routes) {\n    const method = route.method.toLowerCase() as \"get\" | \"post\" | \"put\" | \"delete\" | \"patch\" | \"options\" | \"head\";\n\n    const hasGuards = route.guards.length > 0;\n    const hasMiddlewares = route.middlewares.length > 0;\n    const guardsInfo = hasGuards ? ` [${route.guards.length} guard(s)]` : \"\";\n    const middlewaresInfo = hasMiddlewares ? ` [${route.middlewares.length} middleware(s)]` : \"\";\n\n    fastify[method](route.path, {\n      schema: route.schema,\n      handler: async (request, reply) => {\n        try {\n          const context: RouteContext = {\n            request,\n            reply,\n            params: request.params as any,\n            query: request.query as any,\n            body: request.body as any,\n          };\n          // attach a few convenience values available to response resolvers\n          (context as any).requestTimestamp = new Date().toISOString();\n          (context as any).ip = (request.headers && (request.headers[\"x-forwarded-for\"] || request.ip)) || request.ip;\n\n          // Execute guards first\n          for (const guard of route.guards) {\n            const allowed = await guard(context);\n            if (!allowed) {\n              reply.code(403);\n              return { error: \"Forbidden\", message: \"Access denied by guard\" };\n            }\n          }\n\n          // Execute middlewares\n          let middlewareIndex = 0;\n          const executeMiddleware = async (): Promise<void> => {\n            if (middlewareIndex < route.middlewares.length) {\n              const middleware = route.middlewares[middlewareIndex++];\n              await middleware(context, executeMiddleware);\n            }\n          };\n          await executeMiddleware();\n\n          // Execute the main handler\n          const result = await route.handler(context);\n\n          // If the handler returned a Page element, render it to HTML\n          if (isPageElement(result)) {\n            const props: any = result.props || {};\n\n            // Resolve context-based props\n            const title = resolveWithContext(props.title ?? \"React App\", context);\n            const meta = resolveWithContext(props.meta ?? [], context);\n            const links = resolveWithContext(props.links ?? [], context);\n            const scripts = resolveWithContext(props.scripts ?? [], context);\n            const styles = resolveWithContext(props.styles ?? \"\", context);\n            const status = resolveWithContext(props.status ?? 200, context);\n            const headers = resolveWithContext(props.headers ?? {}, context);\n            const lang = props.lang ?? \"en\";\n            const doctype = props.doctype ?? \"<!DOCTYPE html>\";\n            const htmlAttributes = props.htmlAttributes ?? {};\n            const bodyAttributes = props.bodyAttributes ?? {};\n            const rootId = props.rootId ?? \"root\";\n            const isSPA = props.spa ?? false;\n\n            // Handle client-side component bundling for SPA mode\n            let clientBundleHash: string | null = null;\n            let clientPropsHash: string | null = null;\n\n            if (isSPA && props.children && React.isValidElement(props.children)) {\n              // Auto-detect and bundle the component\n              const componentInfo = extractComponentInfo(props.children);\n\n              if (componentInfo.filePath) {\n                try {\n                  // Watch file in development mode for hot reload\n                  if (process.env.NODE_ENV === \"development\") {\n                    watchComponentFile(componentInfo.filePath, () => {\n                      // On file change, remove old bundles from cache\n                      // The next request will trigger a fresh bundle\n                      const oldHash = clientBundleHash;\n                      if (oldHash) {\n                        componentBundles.delete(oldHash);\n                        fastify.log.info(`Cleared bundle cache for: ${componentInfo.filePath}`);\n                      }\n                    });\n                  }\n\n                  fastify.log.info(`Bundling SPA component: ${componentInfo.componentName} from ${componentInfo.filePath}`);\n                  const bundle = await bundleComponentFile(componentInfo.filePath);\n                  clientBundleHash = bundle.hash;\n\n                  // Store the bundle so we can serve it\n                  componentBundles.set(clientBundleHash, bundle.code);\n\n                  // Create and store the props script\n                  const serializedProps = JSON.stringify(componentInfo.props);\n                  const propsScript = `window.__INITIAL_PROPS__ = ${serializedProps};`;\n                  clientPropsHash = crypto.createHash(\"md5\").update(propsScript).digest(\"hex\");\n                  propsScripts.set(clientPropsHash, propsScript);\n                } catch (error) {\n                  fastify.log.error(\n                    { error: error instanceof Error ? error.message : String(error), stack: error instanceof Error ? error.stack : undefined },\n                    `Error bundling SPA component from ${componentInfo.filePath}`\n                  );\n                  // Continue without client bundle\n                }\n              } else {\n                fastify.log.warn(`SPA mode enabled but could not detect component file path for: ${componentInfo.componentName}`);\n              }\n            }\n\n            // For client-side SPAs, don't render server-side - just provide empty shell\n            // For static pages, render server-side\n            let contentHtml = \"\";\n            if (!isSPA && props.children) {\n              // Static server-side rendering only\n              try {\n                contentHtml = renderToString(props.children as React.ReactElement);\n              } catch (error) {\n                fastify.log.error({ error }, \"Error rendering Page content\");\n                contentHtml = `<div>Error rendering content: ${error instanceof Error ? error.message : String(error)}</div>`;\n              }\n            }\n            // If SPA mode, contentHtml stays empty - pure client-side rendering\n\n            // Helper to escape HTML\n            const escapeHtml = (text: string): string => {\n              const map: Record<string, string> = {\n                \"&\": \"&amp;\",\n                \"<\": \"&lt;\",\n                \">\": \"&gt;\",\n                '\"': \"&quot;\",\n                \"'\": \"&#039;\",\n              };\n              return text.replace(/[&<>\"']/g, (char) => map[char]);\n            };\n\n            // Build HTML attributes string\n            const htmlAttrsString = Object.entries(htmlAttributes)\n              .map(([key, value]) => `${key}=\"${escapeHtml(String(value))}\"`)\n              .join(\" \");\n\n            // Build body attributes string\n            const bodyAttrsString = Object.entries(bodyAttributes)\n              .map(([key, value]) => `${key}=\"${escapeHtml(String(value))}\"`)\n              .join(\" \");\n\n            // Build meta tags\n            const metaTags = (meta as any[])\n              .map((m: any) => {\n                if (m.property) {\n                  return `<meta property=\"${escapeHtml(m.property)}\" content=\"${escapeHtml(m.content)}\">`;\n                }\n                return `<meta name=\"${escapeHtml(m.name || \"\")}\" content=\"${escapeHtml(m.content)}\">`;\n              })\n              .join(\"\\n    \");\n\n            // Build link tags\n            const linkTags = (links as any[])\n              .map((link: any) => {\n                const attrs = Object.entries(link)\n                  .map(([key, value]) => `${key}=\"${escapeHtml(String(value))}\"`)\n                  .join(\" \");\n                return `<link ${attrs}>`;\n              })\n              .join(\"\\n    \");\n\n            // Build script tags\n            const scriptTags = (scripts as any[])\n              .map((script: any) => {\n                const attrs: string[] = [];\n                if (script.src) attrs.push(`src=\"${escapeHtml(script.src)}\"`);\n                if (script.async) attrs.push(\"async\");\n                if (script.defer) attrs.push(\"defer\");\n                if (script.type) attrs.push(`type=\"${escapeHtml(script.type)}\"`);\n\n                const attrsString = attrs.join(\" \");\n                const content = script.content || \"\";\n\n                return `<script ${attrsString}>${content}</script>`;\n              })\n              .join(\"\\n    \");\n\n            // Build the complete HTML document\n            const html = `${doctype}\n<html lang=\"${escapeHtml(lang)}\"${htmlAttrsString ? \" \" + htmlAttrsString : \"\"}>\n  <head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>${escapeHtml(title)}</title>${metaTags ? \"\\n    \" + metaTags : \"\"}${linkTags ? \"\\n    \" + linkTags : \"\"}${\n              styles ? `\\n    <style>${styles}</style>` : \"\"\n            }${scriptTags ? \"\\n    \" + scriptTags : \"\"}${clientPropsHash ? `\\n    <script type=\"module\" src=\"/__props/${clientPropsHash}.js\"></script>` : \"\"}${\n              clientBundleHash ? `\\n    <script type=\"module\" src=\"/__bundles/${clientBundleHash}.js\"></script>` : \"\"\n            }\n  </head>\n  <body${bodyAttrsString ? \" \" + bodyAttrsString : \"\"}>\n    <div id=\"${escapeHtml(rootId)}\">${contentHtml}</div>\n  </body>\n</html>`;\n\n            // Set headers\n            for (const k of Object.keys(headers || {})) {\n              reply.header(k, headers[k]);\n            }\n\n            // Set content-type to HTML\n            reply.header(\"Content-Type\", \"text/html; charset=utf-8\");\n\n            if (status !== undefined) reply.code(status);\n\n            return reply.send(html);\n          }\n\n          // If the handler returned a Response element, resolve it and send\n          if (isResponseElement(result)) {\n            const props: any = result.props || {};\n            const status = resolveWithContext(props.status ?? 200, context);\n            const headers = resolveWithContext(props.headers ?? {}, context);\n            const json = resolveWithContext(props.json, context);\n            const raw = resolveWithContext(props.raw, context);\n\n            // set headers\n            for (const k of Object.keys(headers || {})) {\n              reply.header(k, headers[k]);\n            }\n\n            if (status !== undefined) reply.code(status);\n\n            if (raw !== undefined) {\n              // send raw value\n              return reply.send(raw);\n            }\n\n            return reply.send(json);\n          }\n\n          // If the handler hasn't already sent a response, send the result\n          if (!reply.sent) {\n            return result;\n          }\n        } catch (error) {\n          fastify.log.error(error);\n          throw error;\n        }\n      },\n    });\n\n    console.log(`   ${route.method.padEnd(7)} ${route.path}${guardsInfo}${middlewaresInfo}`);\n  }\n\n  // Start the server\n  try {\n    await fastify.listen({ port, host });\n    console.log(`\\n Server running at http://${host}:${port}\\n`);\n  } catch (err) {\n    fastify.log.error(err);\n    process.exit(1);\n  }\n\n  return fastify;\n}\n"]}